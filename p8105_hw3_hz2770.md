p8105\_hw3\_hz2770
================
Hao Zheng
2021/10/16

``` r
library(tidyverse)
```

    ## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --

    ## v ggplot2 3.3.5     v purrr   0.3.4
    ## v tibble  3.1.4     v dplyr   1.0.7
    ## v tidyr   1.1.3     v stringr 1.4.0
    ## v readr   2.0.1     v forcats 0.5.1

    ## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

## Problem 1

First, load the “instacart” dataset.

``` r
library(p8105.datasets)
data("instacart")
```

1.  Now, we want to see how many aisles are there in the dataset
    “instacart” and which aisle has the most orders.

``` r
sum_by_aisle = 
  instacart %>% 
  group_by(aisle) %>% 
  summarise(n_obs = n())

sum_by_aisle
```

    ## # A tibble: 134 x 2
    ##    aisle                  n_obs
    ##    <chr>                  <int>
    ##  1 air fresheners candles  1067
    ##  2 asian foods             7007
    ##  3 baby accessories         306
    ##  4 baby bath body care      328
    ##  5 baby food formula      13198
    ##  6 bakery desserts         1501
    ##  7 baking ingredients     13088
    ##  8 baking supplies decor   1094
    ##  9 beauty                   287
    ## 10 beers coolers           1839
    ## # ... with 124 more rows

``` r
sum_by_aisle %>% 
  filter(min_rank(desc(n_obs))< 2)
```

    ## # A tibble: 1 x 2
    ##   aisle             n_obs
    ##   <chr>             <int>
    ## 1 fresh vegetables 150609

There are 134 aisles in total, and the most items are ordered from the
aisle “fresh vegetables”, which is 1.50609^{5} in total.

2.  Then we try to show the number of items sold in each aisle with a
    number over 10000 via a scatter plot.

``` r
filter_sum_by_aisle = 
  sum_by_aisle %>% 
  filter(n_obs > 10000)

filter_sum_by_aisle
```

    ## # A tibble: 39 x 2
    ##    aisle                    n_obs
    ##    <chr>                    <int>
    ##  1 baby food formula        13198
    ##  2 baking ingredients       13088
    ##  3 bread                    23635
    ##  4 butter                   10575
    ##  5 candy chocolate          11453
    ##  6 canned jarred vegetables 12679
    ##  7 canned meals beans       11774
    ##  8 cereal                   16201
    ##  9 chips pretzels           31269
    ## 10 crackers                 19592
    ## # ... with 29 more rows

``` r
filter_sum_by_aisle %>%
  ggplot(aes(x = aisle, y = n_obs)) +
  geom_point() +
  labs(x = NULL, y = NULL) +
  scale_y_continuous(
    breaks = c(20000, 60000, 100000, 140000, 180000),
    labels = c("20000", "60000", "100000", "140000", "180000")
  ) +
  theme(axis.text.x = element_text(angle=90, hjust=1))
```

![](p8105_hw3_hz2770_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

Then we got that there are 39 aisles in total have more than 10000 items
sold, among which, “fresh fruits” and “fresh vegetables” have the most
sold.

3.  Create a table to show the top three items in aisle “baking
    ingredients”, “dog food care” and “packaged vegetables fruits”.

``` r
# first filter the top three items for each of the three desired aisles.

bak_ingr_rank = 
  instacart %>% 
  filter(aisle == "baking ingredients") %>%
  group_by(product_name) %>%
  summarise(n_obs = n()) %>% 
  filter(min_rank(desc(n_obs)) < 4) %>% 
  mutate(aisle ="baking ingredients",
         rank_in_aisle = min_rank(desc(n_obs))) %>%
  arrange(desc(n_obs))

bak_ingr_rank
```

    ## # A tibble: 3 x 4
    ##   product_name      n_obs aisle              rank_in_aisle
    ##   <chr>             <int> <chr>                      <int>
    ## 1 Light Brown Sugar   499 baking ingredients             1
    ## 2 Pure Baking Soda    387 baking ingredients             2
    ## 3 Cane Sugar          336 baking ingredients             3

``` r
dog_food_rank = 
  instacart %>% 
  filter(aisle == "dog food care") %>%
  group_by(product_name) %>%
  summarise(n_obs = n()) %>% 
  filter(min_rank(desc(n_obs)) < 4) %>% 
  mutate(aisle ="dog food care",
         rank_in_aisle = min_rank(desc(n_obs))) %>%
  arrange(desc(n_obs))

dog_food_rank
```

    ## # A tibble: 3 x 4
    ##   product_name                                  n_obs aisle         rank_in_aisle
    ##   <chr>                                         <int> <chr>                 <int>
    ## 1 Snack Sticks Chicken & Rice Recipe Dog Treats    30 dog food care             1
    ## 2 Organix Chicken & Brown Rice Recipe              28 dog food care             2
    ## 3 Small Dog Biscuits                               26 dog food care             3

``` r
pack_veg_rank = 
  instacart %>% 
  filter(aisle == "packaged vegetables fruits") %>%
  group_by(product_name) %>%
  summarise(n_obs = n()) %>% 
  filter(min_rank(desc(n_obs)) < 4) %>% 
  mutate(aisle ="packaged vegetables fruits",
         rank_in_aisle = min_rank(desc(n_obs))) %>%
  arrange(desc(n_obs))

pack_veg_rank
```

    ## # A tibble: 3 x 4
    ##   product_name         n_obs aisle                      rank_in_aisle
    ##   <chr>                <int> <chr>                              <int>
    ## 1 Organic Baby Spinach  9784 packaged vegetables fruits             1
    ## 2 Organic Raspberries   5546 packaged vegetables fruits             2
    ## 3 Organic Blueberries   4966 packaged vegetables fruits             3

``` r
# Bind all the three tables into one and reorder it to make it clearer.
final_rank = 
  bind_rows(bak_ingr_rank, dog_food_rank, pack_veg_rank) %>% 
  select(aisle, rank_in_aisle, product_name, n_obs)

final_rank
```

    ## # A tibble: 9 x 4
    ##   aisle                      rank_in_aisle product_name                    n_obs
    ##   <chr>                              <int> <chr>                           <int>
    ## 1 baking ingredients                     1 Light Brown Sugar                 499
    ## 2 baking ingredients                     2 Pure Baking Soda                  387
    ## 3 baking ingredients                     3 Cane Sugar                        336
    ## 4 dog food care                          1 Snack Sticks Chicken & Rice Re~    30
    ## 5 dog food care                          2 Organix Chicken & Brown Rice R~    28
    ## 6 dog food care                          3 Small Dog Biscuits                 26
    ## 7 packaged vegetables fruits             1 Organic Baby Spinach             9784
    ## 8 packaged vegetables fruits             2 Organic Raspberries              5546
    ## 9 packaged vegetables fruits             3 Organic Blueberries              4966
